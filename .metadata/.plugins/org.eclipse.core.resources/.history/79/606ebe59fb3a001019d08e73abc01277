package AmazonPractice1;

import java.io.IOException;

import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;
import org.testng.Reporter;
import org.testng.annotations.Test;

import Utilities.BaseClass;
import Utilities.FetchDataFromExcel;

public class LoginToAmazon extends BaseClass {

	@Test
	public void login_ToAmazon() throws IOException {

		WebElement signinHover = driver.findElement(By.xpath("//span[text()='Hello, sign in']"));
		Actions action = new Actions(driver);
		action.moveToElement(signinHover).perform();

		WebElement siginBtn = driver.findElement(By.xpath("//span[text()='Sign in']"));
		siginBtn.click();

		// driver.getTitle();

		// Data Driven
		String fileLocation = "C:\\Users\\welcome\\eclipse-workspace\\GroTechMindsSelenium\\TestNGProject1\\TestData\\TestDataPersonal.xlsx";

		String mobilenumber = FetchDataFromExcel.getNumericDataMethod(fileLocation, 0, 1, 0);
		// String password = FetchDataFromExcel.getStringDataMethod(fileLocation, 0, 1,
		// 1);

		WebElement username = driver.findElement(By.xpath("//input[@name='email']"));
		username.sendKeys(mobilenumber);

		WebElement continueBtn = driver.findElement(By.xpath("//input[@type='submit']"));
		continueBtn.click();

		WebElement profile = driver.findElement(By.xpath("//span[text()='Hello, Aravindhan']"));

		Reporter.log("Successfully Logged Into Amazon");
	}

}
